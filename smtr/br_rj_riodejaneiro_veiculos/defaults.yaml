# Definição de taxa de atualização
scheduling:
  cron: "0 * * * *"

# Definição de particionamento
# - column: nome da coluna
# - type: deve ser um dos seguintes
#   * DATE (não exige período)
#   * DATE_TRUNC (exige período MONTH/YEAR)
#   * DATETIME_TRUNC (exige período DAY/HOUR/MONTH/YEAR)
#   * TIMESTAMP_TRUNC (exige período DAY/HOUR/MONTH/YEAR)
#   * <To-do> RANGE_BUCKET
#   * <To-do> GENERATE_ARRAY
# - period: período (conforme especificado acima)
partitioning:
  column: "data"
  type: ""
  period: ""

# Parâmetros de backfill
backfill:
  # Formato %Y-%m-%d %H:%M:%S
  start_timestamp: "2021-03-01 00:00:00"
  interval:
    days: 45

# Parâmetros da query
parameters:

  faixa_horaria_minutos: 10 

  # Dependências de tratamento
  sppo_registros_filtrada: "rj-smtr.br_rj_riodejaneiro_onibus_gps.aux_registros_filtrada"
  sppo_velocidade: "rj-smtr.br_rj_riodejaneiro_onibus_gps.aux_registros_velocidade" # gps_sppo
  sppo_parada: "rj-smtr.br_rj_riodejaneiro_onibus_gps.aux_registros_parada" # gps_sppo
  sppo_flag_trajeto_correto: "rj-smtr.br_rj_riodejaneiro_onibus_gps.aux_registros_flag_trajeto_correto" # gps_sppo
  gps_sppo: "rj-smtr.br_rj_riodejaneiro_veiculos.gps_sppo" # gps_sppo_agg_*
  brt_registros_filtrada: "rj-smtr.br_rj_riodejaneiro_brt_gps.aux_registros_filtrada"
  brt_velocidade: "rj-smtr.br_rj_riodejaneiro_brt_gps.aux_registros_velocidade" # gps_brt
  brt_parada: "rj-smtr.br_rj_riodejaneiro_brt_gps.aux_registros_parada" # gps_brt
  brt_flag_trajeto_correto: "rj-smtr.br_rj_riodejaneiro_brt_gps.aux_registros_flag_trajeto_correto" # gps_brt
  # Dependências do SIGMOB
  data_versao_efetiva: rj-smtr.br_rj_riodejaneiro_sigmob.data_versao_efetiva # gps_sppo_agg_data_faixa_consorcio
  routes: rj-smtr.br_rj_riodejaneiro_sigmob.routes_desaninhada # gps_sppo_agg_data_faixa_consorcio
  agency: rj-smtr.br_rj_riodejaneiro_sigmob.agency # gps_sppo_agg_data_faixa_consorcio

# Lista de views do dataset
# Atributos de cada view:
# - name: nome sem terminação .sql ou .yaml
# - materialized: true|false para materializar ou não
# - depends_on: lista de views das quais ela depende
views:
  gps_sppo:
    materialized: true
    depends_on:
      - br_rj_riodejaneiro_onibus_gps.aux_registros_filtrada
      - br_rj_riodejaneiro_onibus_gps.aux_registros_velocidade
      - br_rj_riodejaneiro_onibus_gps.aux_registros_parada
      - br_rj_riodejaneiro_onibus_gps.aux_registros_flag_trajeto_correto
  # gps_brt:
  #   materialized: true
  #   depends_on:
  #     - br_rj_riodejaneiro_brt_gps.aux_registros_filtrada
  #     - br_rj_riodejaneiro_brt_gps.aux_registros_velocidade
  #     - br_rj_riodejaneiro_brt_gps.aux_registros_parada
  #     - br_rj_riodejaneiro_brt_gps.aux_registros_flag_trajeto_correto
